<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>OpenGL-BufferObject | byhj zzZ~~~</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="IntrodutionBuffer Objects是存储OpenGL Context(GPU)分配的一组非格式化内存的OpenGL Objects. 这些内存能够用来存储顶点数据，图像或者帧缓存返回的像素数据和其它数据。
CreationBuffer Objects是OpenGL Objects,所以它们遵循所有OpenGL Objects的规定。你能使用glGenBuffersc创建Buffer">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenGL-BufferObject">
<meta property="og:url" content="http://byhj.github.io/2015/09/20/OpenGL-BufferObject/index.html">
<meta property="og:site_name" content="byhj zzZ~~~">
<meta property="og:description" content="IntrodutionBuffer Objects是存储OpenGL Context(GPU)分配的一组非格式化内存的OpenGL Objects. 这些内存能够用来存储顶点数据，图像或者帧缓存返回的像素数据和其它数据。
CreationBuffer Objects是OpenGL Objects,所以它们遵循所有OpenGL Objects的规定。你能使用glGenBuffersc创建Buffer">
<meta property="og:updated_time" content="2015-12-17T04:48:10.005Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="OpenGL-BufferObject">
<meta name="twitter:description" content="IntrodutionBuffer Objects是存储OpenGL Context(GPU)分配的一组非格式化内存的OpenGL Objects. 这些内存能够用来存储顶点数据，图像或者帧缓存返回的像素数据和其它数据。
CreationBuffer Objects是OpenGL Objects,所以它们遵循所有OpenGL Objects的规定。你能使用glGenBuffersc创建Buffer">
  
    <link rel="alternative" href="/atom.xml" title="byhj zzZ~~~" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/assets/img/byhj.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">byhj</a></h1>
		</hgroup>

		
		<p class="header-subtitle">世上的鲜花会盛开，壮丽不朽的事物会接踵而来</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/byhj" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/byhj" title="weibo">weibo</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/byhj" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/Book/" style="font-size: 10px;">Book</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/Cocos2dx/" style="font-size: 10px;">Cocos2dx</a> <a href="/tags/D3D/" style="font-size: 13.33px;">D3D</a> <a href="/tags/D3D12/" style="font-size: 13.33px;">D3D12</a> <a href="/tags/DirectX/" style="font-size: 16.67px;">DirectX</a> <a href="/tags/OpenGL/" style="font-size: 20px;">OpenGL</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">爱书爱自然的一只鱼~~</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">byhj</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/assets/img/byhj.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">byhj</h1>
			</hgroup>
			
			<p class="header-subtitle">世上的鲜花会盛开，壮丽不朽的事物会接踵而来</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/byhj" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/byhj" title="weibo">weibo</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/byhj" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-OpenGL-BufferObject" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/20/OpenGL-BufferObject/" class="article-date">
  	<time datetime="2015-09-20T14:40:46.000Z" itemprop="datePublished">2015-09-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      OpenGL-BufferObject
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenGL/">OpenGL</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    
    <div class="article-entry" itemprop="articleBody">
  
    
    <div id="toc" class="article-toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introdution"><span class="toc-number">1.</span> <span class="toc-text">Introdution</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Creation"><span class="toc-number">2.</span> <span class="toc-text">Creation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Immutable_Storage"><span class="toc-number">2.1.</span> <span class="toc-text">Immutable Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Immutable_access_methods"><span class="toc-number">2.1.1.</span> <span class="toc-text">Immutable access methods</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Data_Specification"><span class="toc-number">3.</span> <span class="toc-text">Data Specification</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Clearing"><span class="toc-number">3.1.</span> <span class="toc-text">Clearing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Copying"><span class="toc-number">3.2.</span> <span class="toc-text">Copying</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mapping"><span class="toc-number">3.3.</span> <span class="toc-text">Mapping</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#General_use"><span class="toc-number">4.</span> <span class="toc-text">General use</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Multibind_and_indexed_targets"><span class="toc-number">4.1.</span> <span class="toc-text">Multibind and indexed targets</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol>
      <hr/>
    </div>
    
    <h1 id="Introdution">Introdution</h1><p>Buffer Objects是存储OpenGL Context(GPU)分配的一组非格式化内存的OpenGL Objects. 这些内存能够用来存储顶点数据，图像或者帧缓存返回的像素数据和其它数据。</p>
<h1 id="Creation">Creation</h1><p>Buffer Objects是OpenGL Objects,所以它们遵循所有OpenGL Objects的规定。你能使用glGenBuffersc创建Buffer Objects, 使用glDeleteBuffers删除它们。这些都是大多数OpenGL Object使用的标准生成和创建Objects的模式。<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">glBindBuffer</span><span class="params">(<span class="keyword">enum</span> <span class="keyword">target</span>, uint bufferName)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p>Buffer Objects存储的是任意大小的线性内存数组，这些内存在使用前需要被分配，有两种为Buffer Objects 分配内存的方法：可变或者不可变。为buffer分配不可变内存会改变你跟Buffer Object交互的方式。</p>
<a id="more"></a>
<h2 id="Immutable_Storage">Immutable Storage</h2><p>Buffer Objects被分配为不可变方式时，你不能为这个Buffer重新分配内存。使用explicit invalidation<br>command 或者mapping the buffer.<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">glBufferStorage</span><span class="params">(GLenum <span class="keyword">target</span>, GLsizeiptr size, <span class="keyword">const</span> GLvoid * data, GLbitfield flags)</span></span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="Immutable_access_methods">Immutable access methods</h3><ul>
<li><p>Writing to the buffer with any rendering pipeline process. These include Transform Feedback, Image Load Store, Atomic Counter, and Shader Storage Buffer Object. Basically, anything that is part of the rendering pipeline that can write to a buffer will always work.</p>
</li>
<li><p>Clearing the buffer. Because this only transfers a few bytes of data, it is not considered “client-side” modification.</p>
</li>
<li><p>Copying the buffer. This copies from one buffer to another, so it all happens “server-side”.<br>Invalidating the buffer. This only wipes out the contents of the buffer, so it is considered “server-side”.</p>
</li>
<li><p>Asynchronous pixel transfers into the buffer. This sets the data in a buffer, but only through pure-OpenGL mechanisms.</p>
</li>
<li><p>Using glGetBufferSubData? to read a part of the buffer back to the CPU. This is not a “server-side” operation, but it’s always available regardless.</p>
</li>
</ul>
<hr>
<h1 id="Data_Specification">Data Specification</h1><p>因为glBufferData在分配内存空间同时更新数据，所以并不适合更新那些已经分配内存的数据（这对于immutable storage buffers是不可能的）</p>
<p>我们可以使用下面的函数去更新buffer部分的数据：<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> glBufferSubData(<span class="keyword">enum</span> <span class="keyword">target</span>, intptr offset, sizeiptr size,  <span class="keyword">const</span> <span class="keyword">void</span> *data)</span><br></pre></td></tr></table></figure></p>
<h2 id="Clearing">Clearing</h2><p>Buffer objects 内存能够被部分或全部清除为指定的值。这些函数的工作原理与Pixel Transfer操作类似。<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">glClearBufferData</span><span class="params">(GLenum <span class="keyword">target</span>, GLenum internalformat, GLenum format, GLenum type, <span class="keyword">const</span> <span class="keyword">void</span> * data)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">glClearBufferSubData</span><span class="params">(GLenum <span class="keyword">target</span>, GLenum internalformat, GLintptr offset,  GLsizeiptr size, GLenum format, GLenum type, <span class="keyword">const</span> <span class="keyword">void</span> * data)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p>一个清除全部内容，一个清除部分内容</p>
<h2 id="Copying">Copying</h2><p>一个buffer的数据可以被复制到另一个buffer，我们为源和目标buffer绑定不同的target, 一般使用GL_COPY_READ_BUFFER GL_COPY_WRITE_BUFFER作为相应的标志。<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> glCopyBufferSubData​(GLenum readtarget​, GLenum writetarget​, GLintptr readoffset​,GLintptr writeoffset​, GLsizeiptr <span class="keyword">size</span>​);</span><br></pre></td></tr></table></figure></p>
<p>readtarget是绑定到source buffer上的buffer, 这是复制数据的提供者，writetarget 是绑定到destination buffer的buffer，是复制数据的接受者。</p>
<h2 id="Mapping">Mapping</h2><p>对于一般情况来说，glBufferSubData是一种很好的更新数据方式。但有时取决你的使用方式，它的性能会减低。例如，你的算法生成了一些将要存储至buffer object的数据，你首先必须为这些数据分配暂时的存储区，然后使用glBufferSubData函数复制到OpenGL管理的内存。当你想要将数据写回时，glGetBufferSubData也许并不是你想要的方式， 虽然它看起来功能相像。如果你能得到一个指向buffer object存储区的指针，然后直接写入，这样的方式会非常好。<br>为了达到上面所说的效果，你必须对buffer进行映射以得到一个指向可读写buffer内存的指针。<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void *glMapBufferRange​(GLenum target​, GLintptr <span class="command">offset</span>​, GLsizeiptr <span class="property">length</span>​,GLbitfield access​);</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="General_use">General use</h1><ul>
<li>GL_ARRAY_BUFFER</li>
<li>GL_ELEMENT_ARRAY_BUFFER</li>
<li>GL_COPY_READ_BUFFER &amp; GL_COPY_WRITE_BUFFER</li>
<li>GL_PIXEL_UNPACK_BUFFER &amp; GL_PIXEL_PACK_BUFFER</li>
<li>GL_QUERY_BUFFER</li>
<li>GL_TEXTURE_BUFFER</li>
<li>GL_TRANSFORM_FEEDBACK_BUFFER</li>
<li>GL_UNIFORM_BUFFER</li>
<li>GL_DRAW_INDIRECT_BUFFER</li>
<li>GL_ATOMIC_COUNTER_BUFFER</li>
<li>GL_DISPATCH_INDIRECT_BUFFER</li>
<li>GL_SHADER_STORAGE_BUFFER</li>
</ul>
<p>##Binding indexed targets<br><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void glBindBufferRange​(GLenum <span class="type">target</span>​, GLuint <span class="built_in">index</span>​, GLuint buffer​,  GLintptr offset​, GLsizeiptr <span class="built_in">size</span>​ );</span><br></pre></td></tr></table></figure></p>
<h2 id="Multibind_and_indexed_targets">Multibind and indexed targets</h2><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> glBindBuffersRange​(GLenum <span class="keyword">target</span>​, GLuint first​, GLsizei count​, <span class="keyword">const</span> GLuint *buffers​, <span class="keyword">const</span> GLintptr *offsets​, <span class="keyword">const</span> GLintptr *sizes​);</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Reference">Reference</h1>
  
</div>

    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/09/21/OpenGL-Tutorials/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          OpenGL-Tutorials
        
      </div>
    </a>
  
  
    <a href="/2015/09/18/Direct3D-Pipeline/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Direct3D-Pipeline</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="OpenGL-BufferObject" data-title="OpenGL-BufferObject" data-url="http://byhj.github.io/2015/09/20/OpenGL-BufferObject/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 byhj
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>